{
    "$schema": "BinaPintar CMS Data Schema",
    "$version": "1.1.0",
    "$description": "JSON representation of data models used in BinaPintar Construction CMS with 4 core roles",
    "models": {
        "Project": {
            "description": "Construction project entity",
            "fields": {
                "id": {
                    "type": "string",
                    "format": "uuid",
                    "required": true
                },
                "name": {
                    "type": "string",
                    "required": true
                },
                "status": {
                    "type": "enum",
                    "values": [
                        "Active",
                        "Completed"
                    ],
                    "required": true
                },
                "start_date": {
                    "type": "string",
                    "format": "date",
                    "required": true
                },
                "end_date": {
                    "type": "string",
                    "format": "date",
                    "nullable": true
                },
                "created_at": {
                    "type": "string",
                    "format": "datetime",
                    "required": true
                }
            }
        },
        "Permit": {
            "description": "Project permit/document with expiry tracking",
            "fields": {
                "id": {
                    "type": "string",
                    "format": "uuid",
                    "required": true
                },
                "project_id": {
                    "type": "string",
                    "format": "uuid",
                    "required": true,
                    "references": "Project.id"
                },
                "doc_name": {
                    "type": "string",
                    "required": true
                },
                "expiry_date": {
                    "type": "string",
                    "format": "date",
                    "required": true
                },
                "created_at": {
                    "type": "string",
                    "format": "datetime",
                    "required": true
                }
            }
        },
        "SiteLog": {
            "description": "Daily site progress log with photo and GPS",
            "fields": {
                "id": {
                    "type": "string",
                    "format": "uuid",
                    "required": true
                },
                "project_id": {
                    "type": "string",
                    "format": "uuid",
                    "required": true,
                    "references": "Project.id"
                },
                "supervisor_id": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "references": "UserProfile.id"
                },
                "description": {
                    "type": "string",
                    "required": true
                },
                "photo_url": {
                    "type": "string",
                    "format": "url",
                    "nullable": true
                },
                "metadata": {
                    "type": "object",
                    "nullable": true,
                    "properties": {
                        "latitude": {
                            "type": "number"
                        },
                        "longitude": {
                            "type": "number"
                        },
                        "timestamp": {
                            "type": "string",
                            "format": "datetime"
                        },
                        "device": {
                            "type": "string"
                        }
                    }
                },
                "created_at": {
                    "type": "string",
                    "format": "datetime",
                    "required": true
                }
            }
        },
        "Claim": {
            "description": "Financial claim submitted by subcontractor",
            "fields": {
                "id": {
                    "type": "string",
                    "format": "uuid",
                    "required": true
                },
                "project_id": {
                    "type": "string",
                    "format": "uuid",
                    "required": true,
                    "references": "Project.id"
                },
                "amount": {
                    "type": "number",
                    "format": "decimal",
                    "required": true
                },
                "description": {
                    "type": "string",
                    "required": true
                },
                "status": {
                    "type": "enum",
                    "values": [
                        "Pending",
                        "Approved",
                        "Paid"
                    ],
                    "required": true
                },
                "proof_url": {
                    "type": "string",
                    "format": "url",
                    "nullable": true
                },
                "submitted_by": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "references": "UserProfile.id"
                },
                "approved_by": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "references": "UserProfile.id"
                },
                "created_at": {
                    "type": "string",
                    "format": "datetime",
                    "required": true
                },
                "updated_at": {
                    "type": "string",
                    "format": "datetime",
                    "required": true
                }
            }
        },
        "UserProfile": {
            "description": "User account with role-based access control",
            "fields": {
                "id": {
                    "type": "string",
                    "format": "uuid",
                    "required": true,
                    "references": "auth.users.id"
                },
                "email": {
                    "type": "string",
                    "format": "email",
                    "nullable": true
                },
                "role": {
                    "type": "enum",
                    "values": [
                        "admin",
                        "supervisor",
                        "subcontractor",
                        "client"
                    ],
                    "default": "subcontractor",
                    "required": true
                },
                "full_name": {
                    "type": "string",
                    "nullable": true
                },
                "created_at": {
                    "type": "string",
                    "format": "datetime",
                    "required": true
                }
            }
        }
    },
    "storage_buckets": [
        {
            "name": "site-photos",
            "public": true,
            "description": "Site log photos with EXIF data"
        },
        {
            "name": "claim-invoices",
            "public": true,
            "description": "Subcontractor invoices (PDF/Images)"
        }
    ],
    "roles": {
        "admin": {
            "description": "Full system access & management",
            "permissions": [
                "read_all",
                "write_all",
                "approve_claims",
                "manage_users",
                "delete_records"
            ]
        },
        "supervisor": {
            "description": "Site staff managing daily updates",
            "permissions": [
                "create_site_logs",
                "view_projects",
                "view_permits",
                "read_own_logs"
            ]
        },
        "subcontractor": {
            "description": "External vendors for specific works",
            "permissions": [
                "submit_claims",
                "read_own_claims",
                "view_assigned_projects"
            ]
        },
        "client": {
            "description": "Project owners viewing progress",
            "permissions": [
                "view_assigned_projects",
                "view_logs",
                "view_payment_status"
            ]
        }
    }
}